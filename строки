#include <iostream>
#include <cstring>
#include <windows.h>

using namespace std;

bool isRussianVowel(char c) {
    char vowels[] = "аеёиоуыэюяАЕЁИОУЫЭЮЯ";
    return strchr(vowels, c) != nullptr;
}

int main() {
    SetConsoleCP(1251);
    SetConsoleOutputCP(1251);
    
    const int MAX_LENGTH = 1000;
    char str[MAX_LENGTH];
    char temp[MAX_LENGTH];
    
    cout << "Введите строку: ";
    cin.getline(str, MAX_LENGTH);
    
    strcpy(temp, str);
    
    // 1
    cout << "\n№1" << endl;
    int wordCount = 0;
    char *word = strtok(temp, " ");
    while (word != nullptr) {
        int len = strlen(word);
        if (len > 0 && word[0] == word[len - 1]) {
            wordCount++;
        }
        word = strtok(nullptr, " ");
    }
    cout << "Количество слов, начинающихся и заканчивающихся на одну букву: " << wordCount << endl;
    
    // 2
    cout << "\n№2" << endl;
    strcpy(temp, str);
    int targetLength;
    cout << "Введите запретную длину: ";
    cin >> targetLength;
    cin.ignore(); 
    
    char result2[MAX_LENGTH] = "";
    word = strtok(temp, " ");
    while (word != nullptr) {
        if (strlen(word) != targetLength) {
            strcat(result2, word);
            strcat(result2, " ");
        }
        word = strtok(nullptr, " ");
    }
    cout << "Строка после удаления слов длиной " << targetLength << ": " << result2 << endl;
    
    // 3
    cout << "\nЗадание 3" << endl;
    strcpy(temp, str);
    char uniqueWords[50][100]; 
    int uniqueCount = 0;
    
    word = strtok(temp, " ");
    while (word != nullptr) {
        bool hasDuplicate = false;
        int len = strlen(word);
        
        for (int i = 0; i < len && !hasDuplicate; i++) {
            for (int j = i + 1; j < len; j++) {
                if (word[i] == word[j]) {
                    hasDuplicate = true;
                    break;
                }
            }
        }
        
        if (!hasDuplicate) {
            strcpy(uniqueWords[uniqueCount], word);
            uniqueCount++;
        }
        word = strtok(nullptr, " ");
    }
    
    cout << "Слова без повторяющихся букв (" << uniqueCount << " штук):" << endl;
    for (int i = 0; i < uniqueCount; i++) {
        cout << i + 1 << ". " << uniqueWords[i] << endl;
    }
    
    // 4
    cout << "\n№4" << endl;
    strcpy(temp, str);
    int duplicateWordNumbers[100];
    int duplicateCount = 0;
    int currentWordNumber = 1;
    
    word = strtok(temp, " ");
    while (word != nullptr) {
        bool hasDuplicate = false;
        int len = strlen(word);
        
        for (int i = 0; i < len && !hasDuplicate; i++) {
            for (int j = i + 1; j < len; j++) {
                if (word[i] == word[j]) {
                    hasDuplicate = true;
                    break;
                }
            }
        }
        
        if (hasDuplicate) {
            duplicateWordNumbers[duplicateCount] = currentWordNumber;
            duplicateCount++;
        }
        
        currentWordNumber++;
        word = strtok(nullptr, " ");
    }
    
    cout << "Номера слов с повторяющимися символами (" << duplicateCount << " слов):" << endl;
    for (int i = 0; i < duplicateCount; i++) {
        cout << duplicateWordNumbers[i] << " ";
    }
    cout << endl;
    
    // 5
    cout << "\n№5" << endl;
    strcpy(temp, str);
    char words[100][100];
    int totalWords = 0;
    
    char *tempCopy = new char[strlen(str) + 1];
    strcpy(tempCopy, str);
    word = strtok(tempCopy, " ");
    while (word != nullptr) {
        strcpy(words[totalWords], word);
        totalWords++;
        word = strtok(nullptr, " ");
    }
    
    int i, j;
    cout << "Введите 2 номера слов для обмена (от 1 до " << totalWords << "): ";
    cin >> i >> j;
    cin.ignore();
    
    if (i >= 1 && i <= totalWords && j >= 1 && j <= totalWords && i != j) {
        char tempWord[100];
        strcpy(tempWord, words[i - 1]);
        strcpy(words[i - 1], words[j - 1]);
        strcpy(words[j - 1], tempWord);
        
        cout << "Строка после обмена слов " << i << " и " << j << ":" << endl;
        for (int k = 0; k < totalWords; k++) {
            cout << words[k] << " ";
        }
        cout << endl;
    } else {
        cout << "Неправильные номера" << endl;
    }
    delete[] tempCopy;
    
    // 6
    cout << "\n№6" << endl;
    strcpy(temp, str);
    int maxLen = -1, minLen = 1000;
    int maxIndex = -1, minIndex = -1;
    
    tempCopy = new char[strlen(str) + 1];
    strcpy(tempCopy, str);
    totalWords = 0;
    
    word = strtok(tempCopy, " ");
    while (word != nullptr) {
        strcpy(words[totalWords], word);
        int len = strlen(word);
        
        if (len > maxLen) {
            maxLen = len;
            maxIndex = totalWords;
        }
        if (len < minLen) {
            minLen = len;
            minIndex = totalWords;
        }
        
        totalWords++;
        word = strtok(nullptr, " ");
    }
    
    if (maxIndex != -1 && minIndex != -1 && maxIndex != minIndex) {
        char tempWord[100];
        strcpy(tempWord, words[maxIndex]);
        strcpy(words[maxIndex], words[minIndex]);
        strcpy(words[minIndex], tempWord);
        
        cout << "Строка после обмена самого длинного и самого короткого слов:" << endl;
        for (int k = 0; k < totalWords; k++) {
            cout << words[k] << " ";
        }
        cout << endl;
    }
    delete[] tempCopy;
    
    // 7
    cout << "\n№7" << endl;
    strcpy(temp, str);
    
    char maxUniqueWord[100] = "";
    int maxUniqueLen = 0;
    
    word = strtok(temp, " ");
    while (word != nullptr) {
        int len = strlen(word);
        bool hasDuplicate = false;
        for (int k = 0; k < len && !hasDuplicate; k++) {
            for (int m = k + 1; m < len; m++) {
                if (word[k] == word[m]) {
                    hasDuplicate = true;
                    break;
                }
            }
        }
        
        if (!hasDuplicate && len > maxUniqueLen) {
            maxUniqueLen = len;
            strcpy(maxUniqueWord, word);
        }
        
        word = strtok(nullptr, " ");
    }
    
    if (maxUniqueLen > 0) {
        cout << "Слово макс длины с различными символами: " << maxUniqueWord 
             << " (длина: " << maxUniqueLen << ")" << endl;
    } else {
        cout << "Нет слов макс длины с уникальными символами" << endl;
    }
    
    // 8
    cout << "\n№8" << endl;
    strcpy(temp, str);
    
    cout << "Слова с более чем двумя гласными буквами:" << endl;
    word = strtok(temp, " ");
    while (word != nullptr) {
        int vowelCount = 0;
        int len = strlen(word);
        
        for (int k = 0; k < len; k++) {
            if (isRussianVowel(word[k])) {
                vowelCount++;
            }
        }
        
        if (vowelCount > 2) {
            cout << word << " (гласных: " << vowelCount << ")" << endl;
        }
        
        word = strtok(nullptr, " ");
    }
    
    // 9
    cout << "\n№9" << endl;
    strcpy(temp, str);
    
    int maxPalindromeLen = 0;
    int maxPalindromeNum = -1;
    currentWordNumber = 1;
    
    word = strtok(temp, " ");
    while (word != nullptr) {
        int len = strlen(word);
        bool isPalindrome = true;
        for (int k = 0; k < len / 2; k++) {
            if (word[k] != word[len - 1 - k]) {
                isPalindrome = false;
                break;
            }
        }
        
        if (isPalindrome && len > maxPalindromeLen) {
            maxPalindromeLen = len;
            maxPalindromeNum = currentWordNumber;
        }
        
        currentWordNumber++;
        word = strtok(nullptr, " ");
    }
    
    if (maxPalindromeNum != -1) {
        cout << "Номер самого длинного слова-палиндрома: " << maxPalindromeNum 
             << " (длина: " << maxPalindromeLen << ")" << endl;
    } else {
        cout << "Нет палиндромов" << endl;
    }
    
    // 10
    cout << "\nЗадание 10" << endl;
    strcpy(temp, str);
    
    char *tempCopy2 = new char[strlen(str) + 1];
    strcpy(tempCopy2, str);
    maxPalindromeLen = 0;
    
    word = strtok(tempCopy2, " ");
    while (word != nullptr) {
        int len = strlen(word);
        bool isPalindrome = true;
        
        for (int k = 0; k < len / 2; k++) {
            if (word[k] != word[len - 1 - k]) {
                isPalindrome = false;
                break;
            }
        }
        
        if (isPalindrome && len > maxPalindromeLen) {
            maxPalindromeLen = len;
        }
        
        word = strtok(nullptr, " ");
    }
    delete[] tempCopy2;
    
    char result10[MAX_LENGTH] = "";
    word = strtok(temp, " ");
    while (word != nullptr) {
        int len = strlen(word);
        bool isPalindrome = true;
        
        for (int k = 0; k < len / 2; k++) {
            if (word[k] != word[len - 1 - k]) {
                isPalindrome = false;
                break;
            }
        }
        if (!(isPalindrome && len == maxPalindromeLen)) {
            strcat(result10, word);
            strcat(result10, " ");
        }
        
        word = strtok(nullptr, " ");
    }
    
    cout << "Строка после удаления слов-палиндромов макс длины (" 
         << maxPalindromeLen << " символов): " << result10 << endl;
    
    return 0;
}
